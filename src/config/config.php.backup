<?php
/**
 * KhidmaApp.com - Temel KonfigÃ¼rasyon DosyasÄ±
 * 
 * Bu dosya uygulamanÄ±n tÃ¼m temel ayarlarÄ±nÄ± iÃ§erir.
 * VeritabanÄ± baÄŸlantÄ±sÄ±, gÃ¼venlik ayarlarÄ± ve genel konfigÃ¼rasyonlar burada tanÄ±mlanÄ±r.
 */

// Hata raporlama ayarlarÄ±
error_reporting(E_ALL);
ini_set('display_errors', 1);

// Karakter kodlamasÄ±
ini_set('default_charset', 'UTF-8');

/**
 * Basit .env dosyasÄ± okuyucu
 * .env dosyasÄ± yoksa varsayÄ±lan deÄŸerleri kullan
 */
function loadEnv($filePath = '.env') {
    $envFile = __DIR__ . '/../../' . $filePath;
    
    if (file_exists($envFile)) {
        $lines = file($envFile, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);
        foreach ($lines as $line) {
            if (strpos($line, '#') === 0) continue; // Yorum satÄ±rlarÄ±
            
            [$key, $value] = explode('=', $line, 2);
            $key = trim($key);
            $value = trim($value, " \t\n\r\0\x0B\"'");
            
            if (!array_key_exists($key, $_ENV)) {
                $_ENV[$key] = $value;
            }
        }
    }
}

// .env dosyasÄ±nÄ± yÃ¼kle
loadEnv();

/**
 * Ã‡evre deÄŸiÅŸkeni oku (varsayÄ±lan deÄŸer ile)
 */
function env($key, $default = null) {
    return $_ENV[$key] ?? $default;
}

// Temel Uygulama AyarlarÄ±
define('APP_ENV', env('APP_ENV', 'local'));
define('APP_DEBUG', env('APP_DEBUG', true));
define('APP_NAME', env('APP_NAME', 'KhidmaApp.com'));

// VeritabanÄ± AyarlarÄ±
define('DB_HOST', env('DB_HOST', '127.0.0.1'));
define('DB_PORT', env('DB_PORT', '3306'));
define('DB_NAME', env('DB_NAME', 'khidmaapp'));
define('DB_USER', env('DB_USER', 'rslkrkmz'));
define('DB_PASS', env('DB_PASS', 'Rr123456'));

// URL AyarlarÄ±
define('BASE_URL', env('BASE_URL', 'http://localhost:8000'));
define('SITE_URL', env('SITE_URL', 'http://localhost:8000'));

// WhatsApp Entegrasyonu
define('WHATSAPP_CHANNEL_URL', env('WHATSAPP_CHANNEL_URL', 'https://whatsapp.com/channel/0029VbCCqZoI1rcjIn9IWV2l'));
define('WHATSAPP_BUSINESS_NUMBER', env('WHATSAPP_BUSINESS_NUMBER', '+966501234567'));

// Site Bilgileri
define('SITE_TITLE_AR', env('SITE_TITLE_AR', 'Ø®Ø¯Ù…Ø© | Ù…Ù†ØµØ© Ø·Ù„Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø§Øª'));
define('SITE_TITLE_EN', env('SITE_TITLE_EN', 'KhidmaApp | Service Request Platform'));
define('CONTACT_PHONE', env('CONTACT_PHONE', '+966501234567'));
define('CONTACT_EMAIL', env('CONTACT_EMAIL', 'info@khidmaapp.com'));

// GÃ¼venlik AyarlarÄ±
define('SESSION_LIFETIME', env('SESSION_LIFETIME', 120) * 60); // dakika * 60
define('CSRF_TOKEN_EXPIRE', env('CSRF_TOKEN_EXPIRE', 3600));

/**
 * VeritabanÄ± BaÄŸlantÄ±sÄ± (PDO)
 * GÃ¼venli prepared statement kullanÄ±mÄ± iÃ§in
 */
function getDatabase() {
    static $pdo = null;
    
    if ($pdo === null) {
        try {
            $dsn = "mysql:host=" . DB_HOST . ";port=" . DB_PORT . ";dbname=" . DB_NAME . ";charset=utf8mb4";
            $options = [
                PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
                PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
                PDO::ATTR_EMULATE_PREPARES => false,
                PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES utf8mb4"
            ];
            
            $pdo = new PDO($dsn, DB_USER, DB_PASS, $options);
        } catch (PDOException $e) {
            // Log hatayÄ± ama output Ã¼retme (JSON response'u bozmamak iÃ§in)
            error_log("Database connection failed: " . $e->getMessage());
            
            if (APP_DEBUG) {
                // Debug modunda bile output Ã¼retme, sadece log'a yaz
                error_log("âš ï¸ WARNING: Database connection failed but app continues without DB");
            }
            
            return null; // Return null, throw exception yok
        }
    }
    
    return $pdo;
}

/**
 * GÃ¼venli input temizleme
 */
function sanitizeInput($input) {
    return htmlspecialchars(trim($input), ENT_QUOTES, 'UTF-8');
}

/**
 * CSRF Token oluÅŸtur
 */
function generateCsrfToken() {
    if (!isset($_SESSION['csrf_token']) || 
        !isset($_SESSION['csrf_token_time']) || 
        (time() - $_SESSION['csrf_token_time']) > CSRF_TOKEN_EXPIRE) {
        
        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
        $_SESSION['csrf_token_time'] = time();
    }
    
    return $_SESSION['csrf_token'];
}

/**
 * CSRF Token doÄŸrula
 */
function verifyCsrfToken($token) {
    return isset($_SESSION['csrf_token']) && 
           hash_equals($_SESSION['csrf_token'], $token) &&
           isset($_SESSION['csrf_token_time']) &&
           (time() - $_SESSION['csrf_token_time']) <= CSRF_TOKEN_EXPIRE;
}

/**
 * Session baÅŸlat
 */
function startSession() {
    if (session_status() === PHP_SESSION_NONE) {
        // Session ayarlarÄ±nÄ± baÅŸlatmadan Ã¶nce yap
        ini_set('session.cookie_httponly', 1);
        ini_set('session.use_strict_mode', 1);
        session_start();
    }
}

// Otomatik session baÅŸlat
startSession();

/**
 * Hizmet tÃ¼rleri (Database'den - Cached)
 * ArapÃ§a-Ä°ngilizce-TÃ¼rkÃ§e
 */
function getServiceTypes($includeInactive = false) {
    static $cache = null;
    static $cacheWithInactive = null;
    
    // Cache varsa dÃ¶ndÃ¼r
    if (!$includeInactive && $cache !== null) {
        return $cache;
    }
    if ($includeInactive && $cacheWithInactive !== null) {
        return $cacheWithInactive;
    }
    
    // Database'den oku
    try {
        $pdo = getDatabase();
        if (!$pdo) {
            // DB baÄŸlantÄ±sÄ± yoksa fallback
            return getFallbackServiceTypes();
        }
        
        $sql = "SELECT service_key, name_ar, name_tr, icon, is_active 
                FROM services ";
        
        if (!$includeInactive) {
            $sql .= "WHERE is_active = 1 ";
        }
        
        $sql .= "ORDER BY display_order ASC, name_tr ASC";
        
        $stmt = $pdo->query($sql);
        $services = $stmt->fetchAll(PDO::FETCH_ASSOC);
        
        $result = [];
        foreach ($services as $service) {
            $result[$service['service_key']] = [
                'ar' => $service['name_ar'],
                'tr' => $service['name_tr'],
                'en' => $service['name_tr'], // EN kullanmÄ±yoruz, TR'yi kopyala
                'icon' => $service['icon'] ?? '',
                'is_active' => (bool)$service['is_active']
            ];
        }
        
        // Cache'e kaydet
        if ($includeInactive) {
            $cacheWithInactive = $result;
        } else {
            $cache = $result;
        }
        
        return $result;
        
    } catch (Exception $e) {
        error_log("âŒ getServiceTypes error: " . $e->getMessage());
        return getFallbackServiceTypes();
    }
}

/**
 * Fallback hizmet tÃ¼rleri (Database eriÅŸilemezse)
 */
function getFallbackServiceTypes() {
    return [
        'paint' => ['ar' => 'Ø¯Ù‡Ø§Ù†', 'en' => 'Painting', 'tr' => 'Boya Badana', 'icon' => 'ðŸŽ¨'],
        'renovation' => ['ar' => 'ØªØ±Ù…ÙŠÙ…', 'en' => 'Renovation', 'tr' => 'Tadilat', 'icon' => 'ðŸ”¨'],
        'plumbing' => ['ar' => 'Ø³Ø¨Ø§ÙƒØ©', 'en' => 'Plumbing', 'tr' => 'SÄ±hhi Tesisat', 'icon' => 'ðŸš°'],
        'electric' => ['ar' => 'ÙƒÙ‡Ø±Ø¨Ø§Ø¡', 'en' => 'Electrical', 'tr' => 'Elektrik', 'icon' => 'âš¡'],
        'cleaning' => ['ar' => 'ØªÙ†Ø¸ÙŠÙ', 'en' => 'Cleaning', 'tr' => 'Temizlik', 'icon' => 'ðŸ§¹'],
        'ac' => ['ar' => 'ØªÙƒÙŠÙŠÙ', 'en' => 'Air Conditioning', 'tr' => 'Klima', 'icon' => 'â„ï¸']
    ];
}

/**
 * Hizmet detay bilgileri (SEO ve iÃ§erik iÃ§in)
 */
function getServiceDetails($serviceKey) {
    $details = [
        'paint' => [
            'title' => 'Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¯Ù‡Ø§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© | Ø¯Ù‡Ø§Ù†Ø§Øª Ø¯Ø§Ø®Ù„ÙŠØ© ÙˆØ®Ø§Ø±Ø¬ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ©',
            'description' => 'Ø®Ø¯Ù…Ø§Øª Ø¯Ù‡Ø§Ù†Ø§Øª Ø´Ø§Ù…Ù„Ø© ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©. Ø¯Ù‡Ø§Ù†Ø§Øª Ø¯Ø§Ø®Ù„ÙŠØ© ÙˆØ®Ø§Ø±Ø¬ÙŠØ© Ø¨Ø£Ø­Ø¯Ø« Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù†. ÙØ±ÙŠÙ‚ Ù…Ø­ØªØ±Ù ÙˆÙ…ÙˆØ§Ø¯ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©.',
            'keywords' => 'Ø¯Ù‡Ø§Ù†Ø§ØªØŒ Ø¯Ù‡Ø§Ù†ØŒ Ø·Ù„Ø§Ø¡ØŒ Ø¯Ù‡Ø§Ù†Ø§Øª Ø¯Ø§Ø®Ù„ÙŠØ©ØŒ Ø¯Ù‡Ø§Ù†Ø§Øª Ø®Ø§Ø±Ø¬ÙŠØ©ØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø¬Ø¯Ø©',
            'content' => [
                'intro' => 'Ù†Ù‚Ø¯Ù… Ø®Ø¯Ù…Ø§Øª Ø¯Ù‡Ø§Ù†Ø§Øª Ø´Ø§Ù…Ù„Ø© ÙˆÙ…ØªÙ…ÙŠØ²Ø© ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø£Ù†Ø­Ø§Ø¡ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©. Ù†Ø³ØªØ®Ø¯Ù… Ø£Ø­Ø¯Ø« Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª ÙˆØ§Ù„Ù…ÙˆØ§Ø¯ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© Ù„Ø¶Ù…Ø§Ù† Ù†ØªØ§Ø¦Ø¬ Ù…Ø«Ø§Ù„ÙŠØ© ØªØ¯ÙˆÙ… Ø·ÙˆÙŠÙ„Ø§Ù‹.',
                'features' => [
                    'Ø¯Ù‡Ø§Ù†Ø§Øª Ø¯Ø§Ø®Ù„ÙŠØ© Ø¨Ø£Ù„ÙˆØ§Ù† Ø¹ØµØ±ÙŠØ© ÙˆÙ…ØªÙ†ÙˆØ¹Ø©',
                    'Ø¯Ù‡Ø§Ù†Ø§Øª Ø®Ø§Ø±Ø¬ÙŠØ© Ù…Ù‚Ø§ÙˆÙ…Ø© Ù„Ù„Ø¹ÙˆØ§Ù…Ù„ Ø§Ù„Ø¬ÙˆÙŠØ©',
                    'Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙˆØ§Ø¯ ØµØ¯ÙŠÙ‚Ø© Ù„Ù„Ø¨ÙŠØ¦Ø© ÙˆØ¢Ù…Ù†Ø©',
                    'ÙØ±ÙŠÙ‚ Ù…Ø­ØªØ±Ù Ø°Ùˆ Ø®Ø¨Ø±Ø© ÙˆØ§Ø³Ø¹Ø©',
                    'Ø¶Ù…Ø§Ù† Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„Ø±Ø¶Ø§ Ø§Ù„ØªØ§Ù…',
                    'Ø£Ø³Ø¹Ø§Ø± ØªÙ†Ø§ÙØ³ÙŠØ© ÙˆØ´ÙØ§ÙØ©'
                ],
                'process' => [
                    'Ø§Ù„ØªØ´Ø§ÙˆØ± ÙˆØ§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø© Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©',
                    'Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©',
                    'Ø§Ù„ØªØ­Ø¶ÙŠØ± ÙˆØ§Ù„ØªØ¬Ù‡ÙŠØ² Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø£Ø³Ø·Ø­',
                    'Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ù„Ù„Ø¯Ù‡Ø§Ù†',
                    'Ø§Ù„Ù„Ù…Ø³Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø© ÙˆØ§Ù„ØªØ³Ù„ÙŠÙ…'
                ]
            ]
        ],
        'renovation' => [
            'title' => 'Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ±Ù…ÙŠÙ… ÙˆØ§Ù„ØªØ¬Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© | ØªØ±Ù…ÙŠÙ… Ù…Ù†Ø§Ø²Ù„ ÙˆÙ…ÙƒØ§ØªØ¨',
            'description' => 'Ø®Ø¯Ù…Ø§Øª ØªØ±Ù…ÙŠÙ… ÙˆØªØ¬Ø¯ÙŠØ¯ Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ù…Ù†Ø§Ø²Ù„ ÙˆØ§Ù„Ù…ÙƒØ§ØªØ¨ ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©. ÙØ±ÙŠÙ‚ Ù…Ø­ØªØ±Ù ÙˆÙ…ÙˆØ§Ø¯ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© Ù„ØªØ­ÙˆÙŠÙ„ Ù…Ø³Ø§Ø­ØªÙƒ Ø¥Ù„Ù‰ Ù…ÙƒØ§Ù† Ø¹ØµØ±ÙŠ ÙˆØ¬Ù…ÙŠÙ„.',
            'keywords' => 'ØªØ±Ù…ÙŠÙ…ØŒ ØªØ¬Ø¯ÙŠØ¯ØŒ ØªØ±Ù…ÙŠÙ… Ù…Ù†Ø§Ø²Ù„ØŒ ØªØ±Ù…ÙŠÙ… Ù…ÙƒØ§ØªØ¨ØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø¬Ø¯Ø©',
            'content' => [
                'intro' => 'Ù†Ù‚Ø¯Ù… Ø®Ø¯Ù…Ø§Øª ØªØ±Ù…ÙŠÙ… ÙˆØªØ¬Ø¯ÙŠØ¯ Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ù…Ù†Ø§Ø²Ù„ ÙˆØ§Ù„Ù…ÙƒØ§ØªØ¨ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø£Ù†Ø­Ø§Ø¡ Ø§Ù„Ù…Ù…Ù„ÙƒØ©. Ù†Ø­ÙˆÙ„ Ù…Ø³Ø§Ø­ØªÙƒ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¥Ù„Ù‰ Ù…ÙƒØ§Ù† Ø¹ØµØ±ÙŠ ÙˆØ¬Ù…ÙŠÙ„ ÙŠÙ„Ø¨ÙŠ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ.',
                'features' => [
                    'ØªØ±Ù…ÙŠÙ… Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ù†Ø§Ø²Ù„ ÙˆØ§Ù„Ù…ÙƒØ§ØªØ¨',
                    'ØªØ¬Ø¯ÙŠØ¯ Ø§Ù„Ø­Ù…Ø§Ù…Ø§Øª ÙˆØ§Ù„Ù…Ø·Ø§Ø¨Ø®',
                    'Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¬Ø¯Ø±Ø§Ù† ÙˆØ§Ù„Ø£Ø³Ù‚Ù',
                    'ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø£Ø±Ø¶ÙŠØ§Øª ÙˆØ§Ù„Ø¨Ù„Ø§Ø·',
                    'Ø¯Ù‡Ø§Ù†Ø§Øª ÙˆØªØ´Ø·ÙŠØ¨Ø§Øª Ù†Ù‡Ø§Ø¦ÙŠØ©',
                    'ØªØµÙ…ÙŠÙ… Ø¯Ø§Ø®Ù„ÙŠ Ø¹ØµØ±ÙŠ'
                ],
                'process' => [
                    'Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…',
                    'Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø·Ø© Ø§Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„ØªØµÙ…ÙŠÙ…',
                    'Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ§Ø¯ ÙˆØ§Ù„Ù…ÙˆØ§ØµÙØ§Øª',
                    'ØªÙ†ÙÙŠØ° Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØªØ±Ù…ÙŠÙ…',
                    'Ø§Ù„ØªØ´Ø·ÙŠØ¨Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©',
                    'Ø§Ù„ØªØ³Ù„ÙŠÙ… ÙˆØ§Ù„Ø¶Ù…Ø§Ù†'
                ]
            ]
        ],
        'plumbing' => [
            'title' => 'Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø³Ø¨Ø§ÙƒØ© ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© | Ø¥ØµÙ„Ø§Ø­ ÙˆØµÙŠØ§Ù†Ø© Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø³Ø¨Ø§ÙƒØ©',
            'description' => 'Ø®Ø¯Ù…Ø§Øª Ø³Ø¨Ø§ÙƒØ© Ø´Ø§Ù…Ù„Ø© ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©. Ø¥ØµÙ„Ø§Ø­ ÙˆØµÙŠØ§Ù†Ø© Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø³Ø¨Ø§ÙƒØ©ØŒ ØªØ±ÙƒÙŠØ¨ ÙˆØµÙŠØ§Ù†Ø© Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØµØ­ÙŠØ©. Ø®Ø¯Ù…Ø© Ø³Ø±ÙŠØ¹Ø© ÙˆÙ…ÙˆØ«ÙˆÙ‚Ø©.',
            'keywords' => 'Ø³Ø¨Ø§ÙƒØ©ØŒ Ø³Ø¨Ø§ÙƒØŒ Ø¥ØµÙ„Ø§Ø­ Ø³Ø¨Ø§ÙƒØ©ØŒ ØµÙŠØ§Ù†Ø© Ø³Ø¨Ø§ÙƒØ©ØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø¬Ø¯Ø©',
            'content' => [
                'intro' => 'Ù†Ù‚Ø¯Ù… Ø®Ø¯Ù…Ø§Øª Ø³Ø¨Ø§ÙƒØ© Ø´Ø§Ù…Ù„Ø© ÙˆÙ…Ø­ØªØ±ÙØ© ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø£Ù†Ø­Ø§Ø¡ Ø§Ù„Ù…Ù…Ù„ÙƒØ©. ÙØ±ÙŠÙ‚ Ù…Ù† Ø§Ù„Ø³Ø¨Ø§ÙƒÙŠÙ† Ø§Ù„Ù…Ø­ØªØ±ÙÙŠÙ† Ø¬Ø§Ù‡Ø² Ù„Ø­Ù„ Ø¬Ù…ÙŠØ¹ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø³Ø¨Ø§ÙƒØ© Ø¨Ø³Ø±Ø¹Ø© ÙˆÙƒÙØ§Ø¡Ø©.',
                'features' => [
                    'Ø¥ØµÙ„Ø§Ø­ ØªØ³Ø±ÙŠØ¨Ø§Øª Ø§Ù„Ù…ÙŠØ§Ù‡',
                    'ØµÙŠØ§Ù†Ø© Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø³Ø¨Ø§ÙƒØ©',
                    'ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØµØ­ÙŠØ©',
                    'ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø¬Ø§Ø±ÙŠ ÙˆØ§Ù„Ø£Ù†Ø§Ø¨ÙŠØ¨',
                    'Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø£Ù†Ø§Ø¨ÙŠØ¨ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©',
                    'Ø®Ø¯Ù…Ø© Ø·ÙˆØ§Ø±Ø¦ 24/7'
                ],
                'process' => [
                    'ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù„Ù„Ù†Ø¸Ø§Ù…',
                    'ØªØ´Ø®ÙŠØµ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨Ø¯Ù‚Ø©',
                    'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø­Ù„ÙˆÙ„ ÙˆØ§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª',
                    'ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª',
                    'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…',
                    'Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹Ù…Ù„'
                ]
            ]
        ],
        'electric' => [
            'title' => 'Ø®Ø¯Ù…Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© | ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ Ù…Ø­ØªØ±Ù ÙˆØµÙŠØ§Ù†Ø© ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©',
            'description' => 'Ø®Ø¯Ù…Ø§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ø´Ø§Ù…Ù„Ø© ÙˆØ¢Ù…Ù†Ø© ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©. ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠÙˆÙ† Ù…Ø­ØªØ±ÙÙˆÙ† Ù„Ø¬Ù…ÙŠØ¹ Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡ ÙˆØ§Ù„ØµÙŠØ§Ù†Ø©. Ø®Ø¯Ù…Ø© Ù…ÙˆØ«ÙˆÙ‚Ø© ÙˆØ¢Ù…Ù†Ø©.',
            'keywords' => 'ÙƒÙ‡Ø±Ø¨Ø§Ø¡ØŒ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØŒ Ø¥ØµÙ„Ø§Ø­ ÙƒÙ‡Ø±Ø¨Ø§Ø¡ØŒ ØµÙŠØ§Ù†Ø© ÙƒÙ‡Ø±Ø¨Ø§Ø¡ØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø¬Ø¯Ø©',
            'content' => [
                'intro' => 'Ù†Ù‚Ø¯Ù… Ø®Ø¯Ù…Ø§Øª ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ø´Ø§Ù…Ù„Ø© ÙˆØ¢Ù…Ù†Ø© ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø£Ù†Ø­Ø§Ø¡ Ø§Ù„Ù…Ù…Ù„ÙƒØ©. ÙØ±ÙŠÙ‚ Ù…Ù† Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠÙŠÙ† Ø§Ù„Ù…Ø­ØªØ±ÙÙŠÙ† Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ÙŠÙ† Ù„Ø¶Ù…Ø§Ù† Ø£Ø¹Ù„Ù‰ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©.',
                'features' => [
                    'Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©',
                    'ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©',
                    'ØµÙŠØ§Ù†Ø© Ø¯ÙˆØ±ÙŠØ© Ø´Ø§Ù…Ù„Ø©',
                    'ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©',
                    'ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø¥Ù†Ø§Ø±Ø© ÙˆØ§Ù„Ù„Ù…Ø¨Ø§Øª',
                    'Ø®Ø¯Ù…Ø© Ø·ÙˆØ§Ø±Ø¦ 24/7'
                ],
                'process' => [
                    'ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù„Ù„Ø£Ù†Ø¸Ù…Ø©',
                    'ØªØ´Ø®ÙŠØµ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©',
                    'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ø¢Ù…Ù†Ø©',
                    'ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª',
                    'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø³Ù„Ø§Ù…Ø©',
                    'Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹Ù…Ù„'
                ]
            ]
        ],
        'cleaning' => [
            'title' => 'Ø®Ø¯Ù…Ø§Øª Ø§Ù„ØªÙ†Ø¸ÙŠÙ ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© | ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„ ÙˆÙ…ÙƒØ§ØªØ¨ Ø§Ø­ØªØ±Ø§ÙÙŠ',
            'description' => 'Ø®Ø¯Ù…Ø§Øª ØªÙ†Ø¸ÙŠÙ Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ù…Ù†Ø§Ø²Ù„ ÙˆØ§Ù„Ù…ÙƒØ§ØªØ¨ ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©. ÙØ±ÙŠÙ‚ Ù…Ø­ØªØ±Ù ÙˆÙ…ÙˆØ§Ø¯ ØªÙ†Ø¸ÙŠÙ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©. Ø®Ø¯Ù…Ø© Ù…ÙˆØ«ÙˆÙ‚Ø© ÙˆÙØ¹Ø§Ù„Ø©.',
            'keywords' => 'ØªÙ†Ø¸ÙŠÙØŒ ØªÙ†Ø¸ÙŠÙ Ù…Ù†Ø§Ø²Ù„ØŒ ØªÙ†Ø¸ÙŠÙ Ù…ÙƒØ§ØªØ¨ØŒ Ø®Ø¯Ù…Ø§Øª ØªÙ†Ø¸ÙŠÙØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø¬Ø¯Ø©',
            'content' => [
                'intro' => 'Ù†Ù‚Ø¯Ù… Ø®Ø¯Ù…Ø§Øª ØªÙ†Ø¸ÙŠÙ Ø´Ø§Ù…Ù„Ø© ÙˆÙ…Ø­ØªØ±ÙØ© Ù„Ù„Ù…Ù†Ø§Ø²Ù„ ÙˆØ§Ù„Ù…ÙƒØ§ØªØ¨ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø£Ù†Ø­Ø§Ø¡ Ø§Ù„Ù…Ù…Ù„ÙƒØ©. ÙØ±ÙŠÙ‚ Ù…Ø¯Ø±Ø¨ ÙˆÙ…ÙˆØ§Ø¯ ØªÙ†Ø¸ÙŠÙ Ø¢Ù…Ù†Ø© ÙˆÙØ¹Ø§Ù„Ø© Ù„Ø¶Ù…Ø§Ù† Ù†Ø¸Ø§ÙØ© Ù…Ø«Ø§Ù„ÙŠØ©.',
                'features' => [
                    'ØªÙ†Ø¸ÙŠÙ Ø´Ø§Ù…Ù„ Ù„Ù„Ù…Ù†Ø§Ø²Ù„',
                    'ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…ÙƒØ§ØªØ¨ ÙˆØ§Ù„Ù…Ø¤Ø³Ø³Ø§Øª',
                    'ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø³Ø¬Ø§Ø¯ ÙˆØ§Ù„Ù…ÙˆÙƒÙŠØª',
                    'ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†ÙˆØ§ÙØ° ÙˆØ§Ù„Ø²Ø¬Ø§Ø¬',
                    'ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø·Ø§Ø¨Ø® ÙˆØ§Ù„Ø­Ù…Ø§Ù…Ø§Øª',
                    'Ø®Ø¯Ù…Ø© ØªÙ†Ø¸ÙŠÙ Ø¯ÙˆØ±ÙŠØ©'
                ],
                'process' => [
                    'ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø³Ø§Ø­Ø©',
                    'Ø¥Ø¹Ø¯Ø§Ø¯ Ø®Ø·Ø© Ø§Ù„ØªÙ†Ø¸ÙŠÙ',
                    'Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙˆØ§Ø¯ Ø¢Ù…Ù†Ø©',
                    'ØªÙ†Ø¸ÙŠÙ Ø´Ø§Ù…Ù„ ÙˆÙ…Ù†Ø¸Ù…',
                    'ÙØ­Øµ Ø§Ù„Ø¬ÙˆØ¯Ø©',
                    'Ø¶Ù…Ø§Ù† Ø§Ù„Ø±Ø¶Ø§'
                ]
            ]
        ],
        'ac' => [
            'title' => 'Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙƒÙŠÙØ§Øª ÙÙŠ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© | ØµÙŠØ§Ù†Ø© ÙˆØªØ±ÙƒÙŠØ¨ Ù…ÙƒÙŠÙØ§Øª Ø§Ù„Ù‡ÙˆØ§Ø¡',
            'description' => 'Ø®Ø¯Ù…Ø§Øª Ù…ÙƒÙŠÙØ§Øª Ø´Ø§Ù…Ù„Ø© ÙÙŠ Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©. ØµÙŠØ§Ù†Ø© ÙˆØªØ±ÙƒÙŠØ¨ Ù…ÙƒÙŠÙØ§Øª Ø§Ù„Ù‡ÙˆØ§Ø¡ Ø¨Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹Ù‡Ø§. ÙØ±ÙŠÙ‚ Ù…Ø­ØªØ±Ù ÙˆØ®Ø¯Ù…Ø© Ø³Ø±ÙŠØ¹Ø©.',
            'keywords' => 'Ù…ÙƒÙŠÙØ§ØªØŒ Ù…ÙƒÙŠÙØŒ ØµÙŠØ§Ù†Ø© Ù…ÙƒÙŠÙØ§ØªØŒ ØªØ±ÙƒÙŠØ¨ Ù…ÙƒÙŠÙØ§ØªØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŒ Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø¬Ø¯Ø©',
            'content' => [
                'intro' => 'Ù†Ù‚Ø¯Ù… Ø®Ø¯Ù…Ø§Øª Ù…ÙƒÙŠÙØ§Øª Ø´Ø§Ù…Ù„Ø© ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø£Ù†Ø­Ø§Ø¡ Ø§Ù„Ù…Ù…Ù„ÙƒØ©. ØµÙŠØ§Ù†Ø© ÙˆØªØ±ÙƒÙŠØ¨ Ù…ÙƒÙŠÙØ§Øª Ø§Ù„Ù‡ÙˆØ§Ø¡ Ø¨Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹Ù‡Ø§ Ù…Ø¹ Ø¶Ù…Ø§Ù† Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ÙƒÙØ§Ø¡Ø©.',
                'features' => [
                    'ØµÙŠØ§Ù†Ø© Ø¯ÙˆØ±ÙŠØ© Ù„Ù„Ù…ÙƒÙŠÙØ§Øª',
                    'Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„',
                    'ØªØ±ÙƒÙŠØ¨ Ù…ÙƒÙŠÙØ§Øª Ø¬Ø¯ÙŠØ¯Ø©',
                    'ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…ÙƒÙŠÙØ§Øª',
                    'Ø´Ø­Ù† Ø§Ù„ØºØ§Ø²',
                    'Ø®Ø¯Ù…Ø© Ø·ÙˆØ§Ø±Ø¦ 24/7'
                ],
                'process' => [
                    'ÙØ­Øµ Ø´Ø§Ù…Ù„ Ù„Ù„Ù…ÙƒÙŠÙ',
                    'ØªØ´Ø®ÙŠØµ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©',
                    'ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø­Ù„ÙˆÙ„',
                    'ØªÙ†ÙÙŠØ° Ø§Ù„ØµÙŠØ§Ù†Ø© Ø£Ùˆ Ø§Ù„Ø¥ØµÙ„Ø§Ø­',
                    'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙƒÙØ§Ø¡Ø©',
                    'Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹Ù…Ù„'
                ]
            ]
        ]
    ];
    
    return $details[$serviceKey] ?? null;
}

/**
 * Åžehirler (ArapÃ§a-Ä°ngilizce-TÃ¼rkÃ§e)
 */
function getCities() {
    return [
        'riyadh' => ['ar' => 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'en' => 'Riyadh', 'tr' => 'Riyad'],
        'jeddah' => ['ar' => 'Ø¬Ø¯Ø©', 'en' => 'Jeddah', 'tr' => 'Cidde'],
        'mecca' => ['ar' => 'Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©', 'en' => 'Mecca', 'tr' => 'Mekke'],
        'medina' => ['ar' => 'Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©', 'en' => 'Medina', 'tr' => 'Medine'],
        'dammam' => ['ar' => 'Ø§Ù„Ø¯Ù…Ø§Ù…', 'en' => 'Dammam', 'tr' => 'Dammam'],
        'khobar' => ['ar' => 'Ø§Ù„Ø®Ø¨Ø±', 'en' => 'Khobar', 'tr' => 'Khobar'],
        'tabuk' => ['ar' => 'ØªØ¨ÙˆÙƒ', 'en' => 'Tabuk', 'tr' => 'TebÃ¼k'],
        'abha' => ['ar' => 'Ø£Ø¨Ù‡Ø§', 'en' => 'Abha', 'tr' => 'Abha']
    ];
}

/**
 * Admin Authentication Functions
 */

/**
 * Admin giriÅŸ kontrolÃ¼
 */
function isAdminLoggedIn() {
    return isset($_SESSION['admin_id']) && isset($_SESSION['admin_username']);
}

/**
 * Admin giriÅŸ yap
 */
function adminLogin($username, $password) {
    $pdo = getDatabase();
    if (!$pdo) {
        return false;
    }
    
    try {
        $stmt = $pdo->prepare("SELECT id, username, password_hash, is_active FROM admins WHERE username = ? LIMIT 1");
        $stmt->execute([$username]);
        $admin = $stmt->fetch(PDO::FETCH_ASSOC);
        
        if ($admin && $admin['is_active'] && password_verify($password, $admin['password_hash'])) {
            $_SESSION['admin_id'] = $admin['id'];
            $_SESSION['admin_username'] = $admin['username'];
            
            // Son giriÅŸ zamanÄ±nÄ± gÃ¼ncelle
            $updateStmt = $pdo->prepare("UPDATE admins SET last_login = NOW() WHERE id = ?");
            $updateStmt->execute([$admin['id']]);
            
            return true;
        }
    } catch (PDOException $e) {
        error_log("Admin login error: " . $e->getMessage());
    }
    
    return false;
}

/**
 * Admin Ã§Ä±kÄ±ÅŸ yap
 */
function adminLogout() {
    unset($_SESSION['admin_id']);
    unset($_SESSION['admin_username']);
    session_destroy();
}

/**
 * Admin sayfasÄ± korumasÄ± (giriÅŸ yapmamÄ±ÅŸsa login'e yÃ¶nlendir)
 */
function requireAdminLogin() {
    if (!isAdminLoggedIn()) {
        header('Location: /admin/login');
        exit;
    }
}
